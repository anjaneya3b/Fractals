<html>
<head>
<title>Fractals2.java</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #cc7832;}
.s1 { color: #a9b7c6;}
.s2 { color: #6a8759;}
.s3 { color: #808080;}
.s4 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
Fractals2.java</font>
</center></td></tr></table>
<pre><span class="s0">package </span><span class="s1">fractals</span><span class="s0">;</span>

import <span class="s1">javax.imageio.ImageIO</span><span class="s0">;</span>
import <span class="s1">javax.swing.ImageIcon</span><span class="s0">;</span>
import <span class="s1">javax.swing.JButton</span><span class="s0">;</span>
import <span class="s1">javax.swing.JLabel</span><span class="s0">;</span>
import <span class="s1">javax.swing.JPanel</span><span class="s0">;</span>
import <span class="s1">javax.swing.JTextField</span><span class="s0">;</span>
import <span class="s1">javax.swing.Timer</span><span class="s0">;</span>
import <span class="s1">javax.swing.event.DocumentEvent</span><span class="s0">;</span>
import <span class="s1">javax.swing.event.DocumentListener</span><span class="s0">;</span>

import <span class="s1">java.awt.Graphics</span><span class="s0">;</span>
import <span class="s1">java.awt.GridBagConstraints</span><span class="s0">;</span>
import <span class="s1">java.awt.GridBagLayout</span><span class="s0">;</span>
import <span class="s1">java.awt.Color</span><span class="s0">;</span>
import <span class="s1">java.awt.Image</span><span class="s0">;</span>
import <span class="s1">java.awt.Insets</span><span class="s0">;</span>
import <span class="s1">java.awt.Point</span><span class="s0">;</span>
import <span class="s1">java.awt.event.ActionEvent</span><span class="s0">;</span>
import <span class="s1">java.awt.event.ActionListener</span><span class="s0">;</span>
import <span class="s1">java.awt.event.MouseAdapter</span><span class="s0">;</span>
import <span class="s1">java.awt.event.MouseEvent</span><span class="s0">;</span>
import <span class="s1">java.awt.geom.Point2D</span><span class="s0">;</span>
import <span class="s1">java.awt.image.BufferedImage</span><span class="s0">;</span>
import <span class="s1">java.awt.image.RenderedImage</span><span class="s0">;</span>
import <span class="s1">java.io.File</span><span class="s0">;</span>
import <span class="s1">java.io.IOException</span><span class="s0">;</span>
import <span class="s1">java.util.Calendar</span><span class="s0">;</span>

<span class="s1">@SuppressWarnings(</span><span class="s2">&quot;serial&quot;</span><span class="s1">)</span>
<span class="s0">public class </span><span class="s1">Fractals2 </span><span class="s0">extends </span><span class="s1">JPanel </span><span class="s0">implements </span><span class="s1">ActionListener {</span>
	<span class="s3">//to do: dimension-based rounding</span>
	//progress thread
	<span class="s0">private int </span><span class="s1">vOffset</span><span class="s0">;</span>
	private int <span class="s1">hOffset</span><span class="s0">;</span>
	private <span class="s1">Image pic</span><span class="s0">;</span>
	private <span class="s1">JButton startBtn</span><span class="s0">;</span>
	private <span class="s1">JButton resetBtn</span><span class="s0">;</span>
	private <span class="s1">JButton imageBtn</span><span class="s0">;</span>
	private <span class="s1">JButton zoomIn</span><span class="s0">;</span>
	private <span class="s1">JButton zoomOut</span><span class="s0">;</span>
	private double <span class="s1">realPart</span><span class="s0">;</span>
	private double <span class="s1">imagPart</span><span class="s0">;</span>
	private double <span class="s1">xMin</span><span class="s0">;</span>
	private double <span class="s1">xMax</span><span class="s0">;</span>
	private double <span class="s1">yMin</span><span class="s0">;</span>
	private double <span class="s1">yMax</span><span class="s0">;</span>
	private double <span class="s1">xWin</span><span class="s0">; </span><span class="s3">//xMax - xMin / 2, used for zoom</span>
	<span class="s0">private double </span><span class="s1">yWin</span><span class="s0">; </span><span class="s3">//aka how offset our max/min is from the center</span>
	<span class="s0">private double </span><span class="s1">xDim</span><span class="s0">;</span>
	private double <span class="s1">yDim</span><span class="s0">;</span>
	private <span class="s1">Point2D center</span><span class="s0">; </span><span class="s3">//our zoom center (uses coordinate plane vals)</span>
	<span class="s0">private </span><span class="s1">JTextField cTxt</span><span class="s0">;</span>
	private <span class="s1">String input</span><span class="s0">;</span>
	private int <span class="s1">divide</span><span class="s0">; </span><span class="s3">//the divide index for our txt input</span>
	<span class="s0">private </span><span class="s1">JLabel picLabel</span><span class="s0">;</span>
	private <span class="s1">JLabel mouseLabel</span><span class="s0">; </span><span class="s3">//shows our center location</span>
	<span class="s0">private </span><span class="s1">JLabel xMinLabel</span><span class="s0">;</span>
	private <span class="s1">JLabel xMaxLabel</span><span class="s0">;</span>
	private <span class="s1">JLabel yMinLabel</span><span class="s0">;</span>
	private <span class="s1">JLabel yMaxLabel</span><span class="s0">;</span>
	private <span class="s1">JLabel progressLbl</span><span class="s0">;</span>
	private int<span class="s1">[][] cells</span><span class="s0">;</span>
	private <span class="s1">Timer timer</span><span class="s0">;</span>

	private double <span class="s1">CReal</span><span class="s0">;</span>
	private double <span class="s1">CImag</span><span class="s0">;</span>
	private double <span class="s1">CTemp</span><span class="s0">;</span>
	private int <span class="s1">k</span><span class="s0">;</span>

	private final double <span class="s1">SIZE = </span><span class="s4">1.5</span><span class="s0">; </span><span class="s3">//how much of the coordinate plane from the origin to begin with</span>

	<span class="s0">public </span><span class="s1">Fractals2(</span><span class="s0">int </span><span class="s1">xSize</span><span class="s0">, int </span><span class="s1">ySize) {</span>
		<span class="s0">super</span><span class="s1">(</span><span class="s0">new </span><span class="s1">GridBagLayout())</span><span class="s0">;                       				</span><span class="s3">// set up graphics window</span>
		<span class="s1">setBackground(Color.LIGHT_GRAY)</span><span class="s0">;</span>
		<span class="s1">addMouseListener(</span><span class="s0">new </span><span class="s1">MAdapter())</span><span class="s0">;</span>
		<span class="s1">addMouseMotionListener(</span><span class="s0">new </span><span class="s1">MAdapter())</span><span class="s0">;</span>
		<span class="s1">setFocusable(</span><span class="s0">true</span><span class="s1">)</span><span class="s0">;</span>
		<span class="s1">setDoubleBuffered(</span><span class="s0">true</span><span class="s1">)</span><span class="s0">;</span>
		<span class="s1">xMin = -</span><span class="s4">1 </span><span class="s1">* SIZE</span><span class="s0">;</span>
		<span class="s1">yMin = -</span><span class="s4">1 </span><span class="s1">* SIZE</span><span class="s0">;</span>

		<span class="s1">xMax = SIZE</span><span class="s0">;</span>
		<span class="s1">yMax = SIZE</span><span class="s0">;</span>
		<span class="s1">xDim = xSize</span><span class="s0">;</span>
		<span class="s1">yDim = ySize</span><span class="s0">;</span>
		<span class="s1">xWin = SIZE</span><span class="s0">;</span>
		<span class="s1">yWin = SIZE</span><span class="s0">;</span>
		<span class="s1">initBtns()</span><span class="s0">;</span>
		<span class="s1">initTxt()</span><span class="s0">;</span>
		<span class="s1">initLabels()</span><span class="s0">;</span>
		<span class="s1">pic = </span><span class="s0">new </span><span class="s1">BufferedImage(xSize</span><span class="s0">, </span><span class="s1">ySize</span><span class="s0">, </span><span class="s1">BufferedImage.TYPE_INT_RGB)</span><span class="s0">;</span>
		<span class="s1">center = </span><span class="s0">new </span><span class="s1">Point.Double()</span><span class="s0">;</span>
		<span class="s1">center.setLocation(</span><span class="s4">0 </span><span class="s0">, </span><span class="s4">0</span><span class="s1">)</span><span class="s0">;</span>

		<span class="s1">cells = </span><span class="s0">new int</span><span class="s1">[xSize][ySize]</span><span class="s0">;</span>

		<span class="s1">picLabel = </span><span class="s0">new </span><span class="s1">JLabel(</span><span class="s0">new </span><span class="s1">ImageIcon(pic))</span><span class="s0">;</span>
		<span class="s1">timer = </span><span class="s0">new </span><span class="s1">Timer(</span><span class="s4">1 </span><span class="s0">, this</span><span class="s1">)</span><span class="s0">;</span>

		<span class="s1">timer.start()</span><span class="s0">;</span>
		<span class="s1">drawCells(pic.getGraphics())</span><span class="s0">;</span>
		<span class="s1">addThingsToPanel()</span><span class="s0">;</span>
	<span class="s1">}</span>

	<span class="s3">//more of that annoying placement code</span>
	<span class="s0">public void </span><span class="s1">addThingsToPanel() {</span>
		GridBagConstraints c = <span class="s0">new </span><span class="s1">GridBagConstraints()</span><span class="s0">;</span>
		<span class="s1">c.anchor = GridBagConstraints.FIRST_LINE_START</span><span class="s0">;</span>
		<span class="s1">c.fill = GridBagConstraints.HORIZONTAL</span><span class="s0">;</span>
		<span class="s1">c.insets = </span><span class="s0">new </span><span class="s1">Insets(</span><span class="s4">1</span><span class="s0">, </span><span class="s4">1</span><span class="s0">, </span><span class="s4">0</span><span class="s0">, </span><span class="s4">1</span><span class="s1">)</span><span class="s0">;</span>
		<span class="s1">c.gridx = </span><span class="s4">0</span><span class="s0">;</span>
		<span class="s1">c.gridy = </span><span class="s4">1</span><span class="s0">;</span>
		<span class="s1">c.gridwidth = </span><span class="s4">6</span><span class="s0">;</span>
		<span class="s1">c.gridheight = </span><span class="s4">14</span><span class="s0">;</span>
		<span class="s1">add(picLabel</span><span class="s0">, </span><span class="s1">c)</span><span class="s0">;</span>
		<span class="s1">c.gridwidth = </span><span class="s4">1</span><span class="s0">;</span>
		<span class="s1">c.gridheight = </span><span class="s4">1</span><span class="s0">;</span>
		<span class="s1">c.insets = </span><span class="s0">new </span><span class="s1">Insets(</span><span class="s4">0</span><span class="s0">, </span><span class="s4">2</span><span class="s0">, </span><span class="s4">0</span><span class="s0">, </span><span class="s4">2</span><span class="s1">)</span><span class="s0">;</span>
		<span class="s1">c.gridx = </span><span class="s4">0</span><span class="s0">;</span>
		<span class="s1">c.gridy = </span><span class="s4">0</span><span class="s0">;</span>
		<span class="s1">add(startBtn</span><span class="s0">, </span><span class="s1">c)</span><span class="s0">;</span>
		<span class="s1">c.gridx = </span><span class="s4">1</span><span class="s0">;</span>
		<span class="s1">c.gridy = </span><span class="s4">0</span><span class="s0">;</span>
		<span class="s1">add(resetBtn</span><span class="s0">, </span><span class="s1">c)</span><span class="s0">;</span>
		<span class="s1">c.gridx = </span><span class="s4">3</span><span class="s0">;</span>
<span class="s3">//        add(speedBtn, c);</span>
		<span class="s1">c.insets = </span><span class="s0">new </span><span class="s1">Insets(</span><span class="s4">0</span><span class="s0">, </span><span class="s4">10</span><span class="s0">, </span><span class="s4">0</span><span class="s0">, </span><span class="s4">10</span><span class="s1">)</span><span class="s0">;</span>
		<span class="s1">c.gridx = </span><span class="s4">4</span><span class="s0">;</span>
		<span class="s1">c.gridy = </span><span class="s4">0</span><span class="s0">;</span>
		<span class="s1">c.fill = GridBagConstraints.VERTICAL</span><span class="s0">;</span>
<span class="s3">//        add(generations, c);</span>
		<span class="s1">c.gridx = </span><span class="s4">5</span><span class="s0">;</span>
		<span class="s1">add(mouseLabel</span><span class="s0">, </span><span class="s1">c)</span><span class="s0">;</span>
		<span class="s1">c.gridx = </span><span class="s4">6</span><span class="s0">;</span>
		<span class="s1">c.gridy = </span><span class="s4">1</span><span class="s0">;</span>
		<span class="s1">c.fill = GridBagConstraints.HORIZONTAL</span><span class="s0">;</span>
		<span class="s1">add(imageBtn</span><span class="s0">, </span><span class="s1">c)</span><span class="s0">;</span>
		<span class="s1">c.gridy = </span><span class="s4">2</span><span class="s0">;</span>
		<span class="s1">c.fill = GridBagConstraints.BOTH</span><span class="s0">;</span>
		<span class="s1">add(</span><span class="s0">new </span><span class="s1">JLabel(</span><span class="s2">&quot;f(z) = z^2 + c&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">c)</span><span class="s0">;</span>
		<span class="s1">c.gridy = </span><span class="s4">3</span><span class="s0">;</span>
		<span class="s1">add(</span><span class="s0">new </span><span class="s1">JLabel(</span><span class="s2">&quot;C&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">c)</span><span class="s0">;</span>
		<span class="s1">c.gridx = </span><span class="s4">7</span><span class="s0">;</span>
		<span class="s1">c.gridy = </span><span class="s4">2</span><span class="s0">;</span>
		<span class="s1">add(</span><span class="s0">new </span><span class="s1">JLabel(</span><span class="s2">&quot;where c = a+bi&quot;</span><span class="s1">)</span><span class="s0">, </span><span class="s1">c)</span><span class="s0">;</span>
		<span class="s1">c.gridy = </span><span class="s4">3</span><span class="s0">;</span>
		<span class="s1">add(cTxt</span><span class="s0">, </span><span class="s1">c)</span><span class="s0">;</span>
		<span class="s1">c.gridy = </span><span class="s4">7</span><span class="s0">;</span>
		<span class="s1">add(xMinLabel</span><span class="s0">, </span><span class="s1">c)</span><span class="s0">;</span>
		<span class="s1">c.gridy = </span><span class="s4">8</span><span class="s0">;</span>
		<span class="s1">add(xMaxLabel</span><span class="s0">, </span><span class="s1">c)</span><span class="s0">;</span>
		<span class="s1">c.gridy = </span><span class="s4">9</span><span class="s0">;</span>
		<span class="s1">add(yMinLabel</span><span class="s0">, </span><span class="s1">c)</span><span class="s0">;</span>
		<span class="s1">c.gridy = </span><span class="s4">10</span><span class="s0">;</span>
		<span class="s1">add(yMaxLabel</span><span class="s0">, </span><span class="s1">c)</span><span class="s0">;</span>
		<span class="s1">c.gridy = </span><span class="s4">11</span><span class="s0">;</span>
		<span class="s1">add(zoomIn </span><span class="s0">, </span><span class="s1">c)</span><span class="s0">;</span>
		<span class="s1">c.gridy = </span><span class="s4">12</span><span class="s0">;</span>
		<span class="s1">add(zoomOut</span><span class="s0">, </span><span class="s1">c)</span><span class="s0">;</span>
		<span class="s1">c.gridy = </span><span class="s4">13</span><span class="s0">;</span>
		<span class="s1">add(progressLbl </span><span class="s0">, </span><span class="s1">c)</span><span class="s0">;</span>
	<span class="s1">}</span>

	<span class="s0">public void </span><span class="s1">initTxt() {</span>

		cTxt = <span class="s0">new </span><span class="s1">JTextField(</span><span class="s2">&quot;0&quot;</span><span class="s0">, </span><span class="s4">8</span><span class="s1">)</span><span class="s0">;</span>
		<span class="s1">cTxt.getDocument().addDocumentListener(</span><span class="s0">new </span><span class="s1">DocumentListener(){</span>
			<span class="s3">//no need to press enter with document listeners</span>
			<span class="s0">public void </span><span class="s1">changedUpdate(DocumentEvent arg0) {</span>
				<span class="s0">try </span><span class="s1">{</span>
					input = cTxt.getText()<span class="s0">;</span>

					for<span class="s1">(</span><span class="s0">int </span><span class="s1">place = </span><span class="s4">1 </span><span class="s0">; </span><span class="s1">place &lt; cTxt.getText().length() </span><span class="s0">; </span><span class="s1">place++)</span>
						<span class="s0">if</span><span class="s1">(input.charAt(place) == </span><span class="s2">'-' </span><span class="s1">|| input.charAt(place) == </span><span class="s2">'+'</span><span class="s1">)</span>
							divide = place<span class="s0">; </span><span class="s3">//finding the + or - in 'a+bi'</span>

					<span class="s1">realPart = Double.parseDouble(input.substring(</span><span class="s4">0</span><span class="s0">, </span><span class="s1">divide))</span><span class="s0">;</span>
					<span class="s1">imagPart = Double.parseDouble(input.substring(divide </span><span class="s0">, </span><span class="s1">input.length()-</span><span class="s4">1</span><span class="s1">))</span><span class="s0">;</span>
				<span class="s1">} </span><span class="s0">catch </span><span class="s1">(NumberFormatException e) {</span>
				}
				<span class="s0">catch </span><span class="s1">(StringIndexOutOfBoundsException d){</span>

				}
			}

			<span class="s0">public void </span><span class="s1">insertUpdate(DocumentEvent arg0) {</span>
				<span class="s0">try </span><span class="s1">{</span>
					input = cTxt.getText()<span class="s0">;</span>

					for<span class="s1">(</span><span class="s0">int </span><span class="s1">place = </span><span class="s4">1 </span><span class="s0">; </span><span class="s1">place &lt; cTxt.getText().length() </span><span class="s0">; </span><span class="s1">place++)</span>
						<span class="s0">if</span><span class="s1">(input.charAt(place) == </span><span class="s2">'-' </span><span class="s1">|| input.charAt(place) == </span><span class="s2">'+'</span><span class="s1">)</span>
							divide = place<span class="s0">;</span>

					<span class="s1">realPart = Double.parseDouble(input.substring(</span><span class="s4">0</span><span class="s0">, </span><span class="s1">divide))</span><span class="s0">;</span>
					<span class="s1">imagPart = Double.parseDouble(input.substring(divide </span><span class="s0">, </span><span class="s1">input.length()-</span><span class="s4">1</span><span class="s1">))</span><span class="s0">;</span>
				<span class="s1">} </span><span class="s0">catch </span><span class="s1">(NumberFormatException e) {</span>
				}
				<span class="s0">catch </span><span class="s1">(StringIndexOutOfBoundsException d){</span>

				}
			}

			<span class="s0">public void </span><span class="s1">removeUpdate(DocumentEvent arg0) {</span>
				<span class="s0">try </span><span class="s1">{</span>
					input = cTxt.getText()<span class="s0">;</span>

					for<span class="s1">(</span><span class="s0">int </span><span class="s1">place = </span><span class="s4">1 </span><span class="s0">; </span><span class="s1">place &lt; cTxt.getText().length() </span><span class="s0">; </span><span class="s1">place++)</span>
						<span class="s0">if</span><span class="s1">(input.charAt(place) == </span><span class="s2">'-' </span><span class="s1">|| input.charAt(place) == </span><span class="s2">'+'</span><span class="s1">)</span>
							divide = place<span class="s0">;</span>

					<span class="s1">realPart = Double.parseDouble(input.substring(</span><span class="s4">0</span><span class="s0">, </span><span class="s1">divide))</span><span class="s0">;</span>
					<span class="s1">imagPart = Double.parseDouble(input.substring(divide </span><span class="s0">, </span><span class="s1">input.length()-</span><span class="s4">1</span><span class="s1">))</span><span class="s0">;</span>
				<span class="s1">} </span><span class="s0">catch </span><span class="s1">(NumberFormatException e) {</span>
				}
				<span class="s0">catch </span><span class="s1">(StringIndexOutOfBoundsException d){</span>

				}
			}

		})<span class="s0">;</span>

	<span class="s1">}</span>

	<span class="s0">public void </span><span class="s1">initBtns() {</span>
		startBtn = <span class="s0">new </span><span class="s1">JButton(</span><span class="s2">&quot;Generate&quot;</span><span class="s1">)</span><span class="s0">;</span>
		<span class="s1">startBtn.addActionListener(</span><span class="s0">new </span><span class="s1">ActionListener() {</span>
			<span class="s0">public void </span><span class="s1">actionPerformed(ActionEvent e) {</span>
				updateCells()<span class="s0">;</span>
				<span class="s1">drawCells(pic.getGraphics())</span><span class="s0">;</span>
				<span class="s1">updateLabels()</span><span class="s0">; </span><span class="s3">//updateLabels() also repaints.</span>
			<span class="s1">}</span>
		})<span class="s0">;</span>

		<span class="s1">resetBtn = </span><span class="s0">new </span><span class="s1">JButton(</span><span class="s2">&quot;Reset&quot;</span><span class="s1">)</span><span class="s0">;</span>
		<span class="s1">resetBtn.addActionListener(</span><span class="s0">new </span><span class="s1">ActionListener() {</span>
			<span class="s0">public void </span><span class="s1">actionPerformed(ActionEvent e) {</span>
				xMin = -<span class="s4">1 </span><span class="s1">* SIZE</span><span class="s0">;</span>
				<span class="s1">yMin = -</span><span class="s4">1 </span><span class="s1">* SIZE</span><span class="s0">;</span>
				<span class="s1">xMax = SIZE</span><span class="s0">;</span>
				<span class="s1">yMax = SIZE</span><span class="s0">;</span>
				<span class="s1">xWin = SIZE</span><span class="s0">;</span>
				<span class="s1">yWin = SIZE</span><span class="s0">;</span>
				<span class="s1">center.setLocation(</span><span class="s4">0</span><span class="s0">,</span><span class="s4">0</span><span class="s1">)</span><span class="s0">;</span>
				<span class="s1">updateCells()</span><span class="s0">;</span>
				<span class="s1">drawCells(pic.getGraphics())</span><span class="s0">;</span>
				<span class="s1">updateLabels()</span><span class="s0">;</span>
			<span class="s1">}</span>
		})<span class="s0">;</span>
		<span class="s1">imageBtn = </span><span class="s0">new </span><span class="s1">JButton(</span><span class="s2">&quot;Save Picture&quot;</span><span class="s1">)</span><span class="s0">;</span>
		<span class="s1">imageBtn.addActionListener(</span><span class="s0">new </span><span class="s1">ActionListener() {</span>
			<span class="s0">public void </span><span class="s1">actionPerformed(ActionEvent e) {</span>
				<span class="s0">try </span><span class="s1">{</span>
					Calendar c = Calendar.getInstance()<span class="s0">;</span>
					<span class="s1">String fileName = </span><span class="s2">&quot;.</span><span class="s0">\\</span><span class="s2">&quot; </span><span class="s1">+ realPart + </span><span class="s2">&quot;+&quot; </span><span class="s1">+ imagPart + </span><span class="s2">&quot;i&quot; </span><span class="s1">+ </span><span class="s2">&quot;@&quot; </span><span class="s1">+ c.get(Calendar.HOUR) + </span><span class="s2">&quot;.&quot; </span><span class="s1">+ c.get(Calendar.MINUTE) + </span><span class="s2">&quot;.&quot; </span><span class="s1">+ c.get(Calendar.SECOND)+ </span><span class="s2">&quot;.png&quot;</span><span class="s0">;</span>
					<span class="s1">System.out.println(fileName)</span><span class="s0">;</span>
					<span class="s1">File outputFile = </span><span class="s0">new </span><span class="s1">File(fileName)</span><span class="s0">;</span>
					<span class="s1">outputFile.createNewFile()</span><span class="s0">;</span>
					<span class="s1">ImageIO.write((RenderedImage) pic</span><span class="s0">, </span><span class="s2">&quot;png&quot;</span><span class="s0">, </span><span class="s1">outputFile)</span><span class="s0">;</span>
				<span class="s1">} </span><span class="s0">catch </span><span class="s1">(IOException e1) {</span>
					e1.printStackTrace()<span class="s0">;</span>
				<span class="s1">}</span>
			}
		})<span class="s0">;</span>
		<span class="s1">zoomIn = </span><span class="s0">new </span><span class="s1">JButton(</span><span class="s2">&quot;Zoom in&quot;</span><span class="s1">)</span><span class="s0">;</span>
		<span class="s1">zoomIn.addActionListener(</span><span class="s0">new </span><span class="s1">ActionListener(){</span>
			<span class="s0">public void </span><span class="s1">actionPerformed(ActionEvent e){</span>
				<span class="s3">//shrinks the area by around 50%</span>
				<span class="s1">xWin*=</span><span class="s4">0.75</span><span class="s0">;</span>
				<span class="s1">yWin*=</span><span class="s4">0.75</span><span class="s0">;</span>
				<span class="s3">//build our window around the center</span>
				<span class="s1">xMax = center.getX() + xWin</span><span class="s0">;</span>
				<span class="s1">xMin = center.getX() - xWin</span><span class="s0">;</span>
				<span class="s1">yMax = center.getY() + yWin</span><span class="s0">;</span>
				<span class="s1">yMin = center.getY() - yWin</span><span class="s0">;</span>
				<span class="s1">updateCells()</span><span class="s0">;</span>
				<span class="s1">drawCells(pic.getGraphics())</span><span class="s0">;</span>
				<span class="s1">updateLabels()</span><span class="s0">;</span>
			<span class="s1">}</span>
		})<span class="s0">;</span>
		<span class="s1">zoomOut = </span><span class="s0">new </span><span class="s1">JButton(</span><span class="s2">&quot;Zoom Out&quot;</span><span class="s1">)</span><span class="s0">;</span>
		<span class="s1">zoomOut.addActionListener(</span><span class="s0">new </span><span class="s1">ActionListener(){</span>
			<span class="s0">public void </span><span class="s1">actionPerformed(ActionEvent e){</span>
				xWin/=<span class="s4">0.75</span><span class="s0">;</span>
				<span class="s1">yWin/=</span><span class="s4">0.75</span><span class="s0">;</span>
				<span class="s1">xMax = center.getX() + xWin</span><span class="s0">;</span>
				<span class="s1">xMin = center.getX() - xWin</span><span class="s0">;</span>
				<span class="s1">yMax = center.getY() + yWin</span><span class="s0">;</span>
				<span class="s1">yMin = center.getY() - yWin</span><span class="s0">;</span>
				<span class="s1">updateCells()</span><span class="s0">;</span>
				<span class="s1">drawCells(pic.getGraphics())</span><span class="s0">;</span>
				<span class="s1">updateLabels()</span><span class="s0">;</span>
			<span class="s1">}</span>
		})<span class="s0">;</span>
	<span class="s1">}</span>

	<span class="s0">private void </span><span class="s1">initLabels() {</span>
		mouseLabel = <span class="s0">new </span><span class="s1">JLabel(</span><span class="s2">&quot;Zoom Center At (0,0)&quot;</span><span class="s1">)</span><span class="s0">;</span>
		<span class="s1">xMinLabel = </span><span class="s0">new </span><span class="s1">JLabel(</span><span class="s2">&quot;xMin: &quot; </span><span class="s1">+ xMin)</span><span class="s0">;</span>
		<span class="s1">xMaxLabel = </span><span class="s0">new </span><span class="s1">JLabel(</span><span class="s2">&quot;xMax: &quot; </span><span class="s1">+ xMax)</span><span class="s0">;</span>
		<span class="s1">yMinLabel = </span><span class="s0">new </span><span class="s1">JLabel(</span><span class="s2">&quot;yMin: &quot; </span><span class="s1">+ yMin)</span><span class="s0">;</span>
		<span class="s1">yMaxLabel = </span><span class="s0">new </span><span class="s1">JLabel(</span><span class="s2">&quot;yMax: &quot; </span><span class="s1">+ yMax)</span><span class="s0">;</span>
		<span class="s1">progressLbl = </span><span class="s0">new </span><span class="s1">JLabel(</span><span class="s2">&quot;Ready&quot;</span><span class="s1">)</span><span class="s0">;</span>
	<span class="s1">}</span>

	<span class="s3">//380-750, using http://www.efg2.com/Lab/ScienceAndEngineering/Spectra.htm chart</span>
	<span class="s0">public static </span><span class="s1">Color makeColor2(</span><span class="s0">int </span><span class="s1">input) {</span>
		<span class="s0">if </span><span class="s1">(input &lt; </span><span class="s4">0</span><span class="s1">) {</span>
			<span class="s0">return </span><span class="s1">Color.BLACK</span><span class="s0">;</span>
		<span class="s1">}</span>
		<span class="s0">if </span><span class="s1">(input &lt; </span><span class="s4">380</span><span class="s1">) {</span>
			input += <span class="s4">380</span><span class="s0">;</span>
		<span class="s1">}</span>
		<span class="s0">int </span><span class="s1">red = </span><span class="s4">0</span><span class="s0">, </span><span class="s1">green = </span><span class="s4">0</span><span class="s0">, </span><span class="s1">blue = </span><span class="s4">0</span><span class="s0">;</span>
		<span class="s3">//red</span>
		<span class="s0">if </span><span class="s1">((input &gt;= </span><span class="s4">520</span><span class="s1">) &amp;&amp; (input &lt;= </span><span class="s4">580</span><span class="s1">)) red = </span><span class="s4">255 </span><span class="s1">* (input - </span><span class="s4">520</span><span class="s1">) / </span><span class="s4">60</span><span class="s0">;</span>
		else if <span class="s1">((input &gt; </span><span class="s4">580</span><span class="s1">) &amp;&amp; (input &lt;= </span><span class="s4">700</span><span class="s1">)) red = </span><span class="s4">255</span><span class="s0">;</span>
		else if <span class="s1">((input &gt; </span><span class="s4">700</span><span class="s1">) &amp;&amp; (input &lt;= </span><span class="s4">750</span><span class="s1">)) red = </span><span class="s4">255 </span><span class="s1">- </span><span class="s4">155 </span><span class="s1">* (input - </span><span class="s4">700</span><span class="s1">) / </span><span class="s4">50</span><span class="s0">; </span><span class="s3">// multiplier was 95, this wraps better</span>
		<span class="s0">else if </span><span class="s1">((input &gt;= </span><span class="s4">380</span><span class="s1">) &amp;&amp; (input &lt;= </span><span class="s4">400</span><span class="s1">)) red = </span><span class="s4">100 </span><span class="s1">+ </span><span class="s4">30 </span><span class="s1">* (input - </span><span class="s4">380</span><span class="s1">) / </span><span class="s4">20</span><span class="s0">;</span>
		else if <span class="s1">((input &gt; </span><span class="s4">400</span><span class="s1">) &amp;&amp; (input &lt;= </span><span class="s4">420</span><span class="s1">)) red = </span><span class="s4">130 </span><span class="s1">- </span><span class="s4">30 </span><span class="s1">* (input - </span><span class="s4">400</span><span class="s1">) / </span><span class="s4">20</span><span class="s0">;</span>
		else if <span class="s1">((input &gt; </span><span class="s4">420</span><span class="s1">) &amp;&amp; (input &lt;= </span><span class="s4">440</span><span class="s1">)) red = </span><span class="s4">100 </span><span class="s1">- </span><span class="s4">100 </span><span class="s1">* (input - </span><span class="s4">420</span><span class="s1">) / </span><span class="s4">20</span><span class="s0">;</span>
		<span class="s3">//green</span>
		<span class="s0">if </span><span class="s1">((input &gt;= </span><span class="s4">440</span><span class="s1">) &amp;&amp; (input &lt;= </span><span class="s4">480</span><span class="s1">)) green = </span><span class="s4">255 </span><span class="s1">* (input - </span><span class="s4">440</span><span class="s1">) / </span><span class="s4">40</span><span class="s0">;</span>
		else if <span class="s1">((input &gt; </span><span class="s4">480</span><span class="s1">) &amp;&amp; (input &lt;= </span><span class="s4">560</span><span class="s1">)) green = </span><span class="s4">255</span><span class="s0">;</span>
		else if <span class="s1">((input &gt; </span><span class="s4">560</span><span class="s1">) &amp;&amp; (input &lt;= </span><span class="s4">645</span><span class="s1">)) green = </span><span class="s4">255 </span><span class="s1">- </span><span class="s4">255 </span><span class="s1">* (input - </span><span class="s4">560</span><span class="s1">) / </span><span class="s4">85</span><span class="s0">;</span>
		<span class="s3">//blue</span>
		<span class="s0">if </span><span class="s1">((input &gt;= </span><span class="s4">380</span><span class="s1">) &amp;&amp; (input &lt;= </span><span class="s4">420</span><span class="s1">)) blue = </span><span class="s4">100 </span><span class="s1">+ </span><span class="s4">155 </span><span class="s1">* (input - </span><span class="s4">380</span><span class="s1">) / </span><span class="s4">40</span><span class="s0">;</span>
		else if <span class="s1">((input &gt; </span><span class="s4">420</span><span class="s1">) &amp;&amp; (input &lt;= </span><span class="s4">490</span><span class="s1">)) blue = </span><span class="s4">255</span><span class="s0">;</span>
		else if <span class="s1">((input &gt; </span><span class="s4">490</span><span class="s1">) &amp;&amp; (input &lt;= </span><span class="s4">510</span><span class="s1">)) blue = </span><span class="s4">255 </span><span class="s1">- </span><span class="s4">255 </span><span class="s1">* (input - </span><span class="s4">490</span><span class="s1">) / </span><span class="s4">20</span><span class="s0">;</span>
		else if <span class="s1">((input &gt; </span><span class="s4">730</span><span class="s1">) &amp;&amp; (input &lt;= </span><span class="s4">750</span><span class="s1">)) blue = </span><span class="s4">100 </span><span class="s1">* (input - </span><span class="s4">730</span><span class="s1">) / </span><span class="s4">20</span><span class="s0">;</span>
		return new <span class="s1">Color(red</span><span class="s0">, </span><span class="s1">green</span><span class="s0">, </span><span class="s1">blue)</span><span class="s0">;</span>
	<span class="s1">}</span>

	<span class="s0">public void </span><span class="s1">paintComponent(Graphics g) { 	                 </span><span class="s3">// draw graphics in the panel</span>
		<span class="s0">super</span><span class="s1">.paintComponent(g)</span><span class="s0">;                              	 </span><span class="s3">// call superclass to make panel display correctly</span>
	<span class="s1">}</span>

	<span class="s3">//@Override</span>
	<span class="s0">public void </span><span class="s1">actionPerformed(ActionEvent e) { 		</span><span class="s3">//things to change every timer tick</span>
		<span class="s1">hOffset = picLabel.getLocationOnScreen().x - getLocationOnScreen().x</span><span class="s0">;</span>
		<span class="s1">vOffset = picLabel.getLocationOnScreen().y - getLocationOnScreen().y</span><span class="s0">;</span>
	<span class="s1">} </span><span class="s3">//all we have to do is keep track of offsets, all the label/drawing things take care of each other.</span>

	//use setColor and fillRect (or drawRect) to adjust the corresponding graphics to cells in the pic variable
	<span class="s0">private void </span><span class="s1">drawCells(Graphics g) {</span>
		<span class="s0">for </span><span class="s1">(</span><span class="s0">int </span><span class="s1">i = </span><span class="s4">0</span><span class="s0">; </span><span class="s1">i &lt; cells.length</span><span class="s0">; </span><span class="s1">i++) {</span>
			<span class="s0">for </span><span class="s1">(</span><span class="s0">int </span><span class="s1">j = </span><span class="s4">0</span><span class="s0">; </span><span class="s1">j &lt; cells[i].length</span><span class="s0">; </span><span class="s1">j++) {</span>
				g.setColor(makeColor2(cells[i][j]))<span class="s0">; </span><span class="s3">//feel free to create your own color function</span>
				<span class="s1">g.drawRect(i</span><span class="s0">, </span><span class="s1">j</span><span class="s0">, </span><span class="s4">1</span><span class="s0">, </span><span class="s4">1</span><span class="s1">)</span><span class="s0">;</span>
			<span class="s1">}</span>
		}
	}

	<span class="s3">//Calculate the k value of each pixel</span>
	<span class="s0">private void </span><span class="s1">updateCells() {</span>

		<span class="s0">for</span><span class="s1">(</span><span class="s0">int </span><span class="s1">x = </span><span class="s4">0 </span><span class="s0">; </span><span class="s1">x &lt; cells.length </span><span class="s0">; </span><span class="s1">x++){</span>
			<span class="s0">for</span><span class="s1">(</span><span class="s0">int </span><span class="s1">y = </span><span class="s4">0 </span><span class="s0">; </span><span class="s1">y &lt; cells[x].length </span><span class="s0">; </span><span class="s1">y++){</span>

				CReal = xMin + x*((xMax - xMin)/xDim)<span class="s0">;</span>
				<span class="s1">CImag = yMin + (yDim-y)*((yMax - yMin)/yDim)</span><span class="s0">;</span>


					<span class="s1">realPart = CReal</span><span class="s0">;  </span><span class="s3">//for the Mandelbrot set (which has no seed)</span>
					<span class="s1">imagPart = CImag</span><span class="s0">;</span>


				<span class="s1">k = </span><span class="s4">0</span><span class="s0">;</span>

				while<span class="s1">(CReal*CReal + CImag*CImag &lt;= </span><span class="s4">4</span><span class="s1">){</span>

					CTemp = CReal * CReal - CImag * CImag + realPart<span class="s0">;</span>
					<span class="s1">CImag = </span><span class="s4">2 </span><span class="s1">* CReal * CImag + imagPart</span><span class="s0">;</span>
					<span class="s1">CReal = CTemp</span><span class="s0">;</span>

					if<span class="s1">(k == </span><span class="s4">371</span><span class="s1">){</span>
						k = -<span class="s4">1</span><span class="s0">;</span>
						break;
					<span class="s1">}</span>

					k++<span class="s0">;</span>
				<span class="s1">}</span>

				cells[x][y] = k<span class="s0">;</span>

			<span class="s1">}</span>
		}


	}
	<span class="s3">//update the labels</span>
	<span class="s0">private void </span><span class="s1">updateLabels() {</span>

		mouseLabel.setText(<span class="s2">&quot;Zoom Center At (&quot; </span><span class="s1">+ center.getX() + </span><span class="s2">&quot; , &quot; </span><span class="s1">+ center.getY() + </span><span class="s2">&quot;)&quot;</span><span class="s1">)</span><span class="s0">;</span>

		<span class="s1">xMinLabel.setText(</span><span class="s2">&quot;xMin: &quot; </span><span class="s1">+ xMin)</span><span class="s0">;</span>
		<span class="s1">xMaxLabel.setText(</span><span class="s2">&quot;xMax: &quot; </span><span class="s1">+ xMax)</span><span class="s0">;</span>
		<span class="s1">yMinLabel.setText(</span><span class="s2">&quot;yMin: &quot; </span><span class="s1">+ yMin)</span><span class="s0">;</span>
		<span class="s1">yMaxLabel.setText(</span><span class="s2">&quot;yMax: &quot; </span><span class="s1">+ yMax)</span><span class="s0">;</span>

		<span class="s1">repaint()</span><span class="s0">;</span>
	<span class="s1">}</span>

	<span class="s3">//For selecting zoom center coordinates</span>
	<span class="s0">private class </span><span class="s1">MAdapter </span><span class="s0">extends </span><span class="s1">MouseAdapter {</span>

		@Override
		<span class="s0">public void </span><span class="s1">mouseClicked(MouseEvent e) {</span>
			<span class="s0">if</span><span class="s1">(e.getX()-hOffset &lt;= cells.length &amp;&amp; e.getX()-hOffset &gt;= </span><span class="s4">0 </span><span class="s1">&amp;&amp; e.getY()-vOffset &lt;= cells.length &amp;&amp; e.getY()-vOffset &gt;= </span><span class="s4">0</span><span class="s1">){</span>
				center.setLocation((xMin + (xMax - xMin) * (<span class="s0">double</span><span class="s1">)(e.getX() - hOffset) / (xDim - </span><span class="s4">1</span><span class="s1">))</span><span class="s0">,</span>
						<span class="s1">(yMax - (yMax - yMin) * (</span><span class="s0">double</span><span class="s1">)(e.getY() - vOffset) / (yDim - </span><span class="s4">1</span><span class="s1">)))</span><span class="s0">;</span>
				<span class="s1">updateLabels()</span><span class="s0">;</span>
			<span class="s1">}</span>
		}

	}

}</pre>
</body>
</html>